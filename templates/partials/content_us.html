<div id="content-us-market" class="hidden">
    <!-- Market Indices -->
    <section class="mb-6">
        <div class="flex items-center justify-between mb-2">
            <h2 class="text-sm font-bold text-gray-300" data-i18n-key="title_us_indices">US Market Indices</h2>
            <div class="flex items-center gap-2">
                <span id="badge-us-indices" class="text-[11px] text-gray-500"></span>
                <span id="us-macro-model-label"
                    class="text-xs text-purple-400 font-bold border border-purple-800 rounded px-2 py-0.5 bg-purple-900/20">Gemini
                    3.0 Macro Analysis</span>
                <span class="text-xs text-gray-500" data-i18n-key="label_real_time">Real-time Data</span>
            </div>
        </div>
        <div id="us-market-indices-container" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
            <!-- Indices populated by JS -->
            <div
                class="bg-gray-900 border border-gray-800 rounded-lg p-3 flex flex-col items-center justify-center h-20 animate-pulse">
                <div class="h-3 w-16 bg-gray-800 rounded mb-2"></div>
                <div class="h-4 w-20 bg-gray-800 rounded"></div>
            </div>
        </div>
    </section>

    <div class="grid grid-cols-12 gap-6">
        <!-- Left Column: Smart Money Picks Table -->
        <div class="col-span-12 lg:col-span-4 flex flex-col gap-6">
            <div class="border border-gray-800 rounded-lg p-4 flex flex-col h-[600px] bg-gray-900/50 backdrop-blur-sm">
                <div class="flex items-center justify-between mb-4 shrink-0">
                    <div>
                        <h2 class="text-lg font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500"
                            data-i18n-key="title_smart_money">
                            Smart Money Picks
                        </h2>
                        <div id="badge-smart-money" class="text-[11px] text-gray-500"></div>
                        <div id="us-smart-money-summary" data-i18n-key="loading_ai" class="text-xs text-gray-400 mt-1">
                            Loading analysis...</div>
                    </div>
                    <div class="flex flex-col items-end gap-1">
                        <select id="us-history-date-select"
                            class="bg-gray-800 text-gray-300 text-xs border border-gray-700 rounded px-2 py-1 focus:outline-none focus:border-blue-500 transition-colors"
                            onchange="loadUSHistoryByDate(this.value)">
                            <option value="">Latest Analysis</option>
                        </select>
                        <button onclick="updateUSMarketDashboard()"
                            class="text-xs text-blue-400 hover:text-white flex items-center gap-1"><i
                                class="fas fa-sync-alt"></i> <span data-i18n-key="btn_refresh">Refresh</span></button>
                    </div>
                </div>

                <div class="overflow-auto flex-1 custom-scrollbar">
                    <table class="w-full text-left border-collapse">
                        <thead class="sticky top-0 bg-gray-900 z-10">
                            <tr class="text-xs text-gray-500 border-b border-gray-800">
                                <th class="p-2">Rank</th>
                                <th class="p-2">Ticker</th>
                                <th class="p-2 text-center">Sector</th>
                                <th class="p-2 text-center">Score</th>
                                <th class="p-2 text-center">AI Rec</th>
                                <th class="p-2 text-center">Rec $</th>
                                <th class="p-2 text-center">Now $</th>
                                <th class="p-2 text-center">Chg%</th>
                                <th class="p-2 text-center">Upside</th>
                            </tr>
                        </thead>
                        <tbody id="us-smart-money-table" class="text-xs">
                            <tr>
                                <td colspan="9" class="p-4 text-center text-gray-500">Loading Smart Money Picks...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ETF Flows (Small) -->
            <div class="border border-gray-800 rounded-lg p-4 bg-gray-900/50 backdrop-blur-sm">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-sm font-bold text-gray-300" data-i18n-key="title_etf_flows">ETF Flows (Top 3)</h3>
                    <div class="flex items-center gap-2">
                        <span id="badge-etf" class="text-[11px] text-gray-500"></span>
                        <span id="us-etf-sentiment" class="text-xs text-gray-500">-</span>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <div class="text-xs text-gray-500 mb-1 border-b border-gray-800 pb-1"
                            data-i18n-key="label_inflows">INFLOWs</div>
                        <div id="us-etf-inflows" class="space-y-1"></div>
                    </div>
                    <div>
                        <div class="text-xs text-gray-500 mb-1 border-b border-gray-800 pb-1"
                            data-i18n-key="label_outflows">OUTFLOWs</div>
                        <div id="us-etf-outflows" class="space-y-1"></div>
                    </div>
                </div>
                <div class="mt-2 pt-2 border-t border-gray-800 text-center">
                    <button id="us-etf-ai-btn"
                        class="text-xs bg-purple-900/30 text-purple-300 px-3 py-1 rounded hover:bg-purple-900/50 transition-colors hidden w-full">
                        <span data-i18n-key="ai_etf_insight">AI ETF Market Insight</span></button>
                    <div id="us-etf-ai-container"
                        class="hidden mt-2 p-2 bg-[#222] rounded text-xs text-left text-gray-300 border border-gray-700">
                        <div id="us-etf-ai-content" class="whitespace-pre-wrap leading-relaxed"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Column: Chart & Analysis -->
        <div class="col-span-12 lg:col-span-8 flex flex-col gap-6">
            <!-- Stock Chart & AI Summary -->
            <div
                class="border border-gray-800 rounded-lg p-4 bg-gray-900/50 backdrop-blur-sm flex flex-col min-h-[600px]">
                <!-- Header -->
                <div class="flex items-start justify-between mb-4 border-b border-[#2a2a2a] pb-2">
                    <div>
                        <div class="flex items-baseline gap-2">
                            <h2 id="us-chart-ticker" class="text-2xl font-bold text-white">SPY</h2>
                            <span id="us-chart-info" class="text-sm text-gray-400">SPDR S&P 500 ETF Trust</span>
                        </div>
                        <div class="flex items-center gap-2 mt-1">
                            <span id="us-chart-grade"
                                class="px-2 py-0.5 rounded text-xs bg-gray-700 text-gray-300">Neutral</span>
                            <div class="flex gap-1" id="us-chart-indicators">
                                <button onclick="toggleIndicator('bb')" id="toggle-bb"
                                    class="px-2 py-0.5 text-xs rounded bg-gray-700 text-gray-300 hover:bg-gray-600">BB</button>
                                <button onclick="toggleIndicator('sr')" id="toggle-sr"
                                    class="px-2 py-0.5 text-xs rounded bg-gray-700 text-gray-300 hover:bg-gray-600">S/R</button>
                                <button onclick="toggleIndicator('rsi')" id="toggle-rsi"
                                    class="px-2 py-0.5 text-xs rounded bg-gray-700 text-gray-300 hover:bg-gray-600">RSI</button>
                                <button onclick="toggleIndicator('macd')" id="toggle-macd"
                                    class="px-2 py-0.5 text-xs rounded bg-gray-700 text-gray-300 hover:bg-gray-600">MACD</button>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center gap-1" id="us-chart-period-btns">
                        <button
                            class="px-2 py-1 text-xs rounded bg-gray-700 text-gray-300 hover:bg-blue-600 hover:text-white transition-colors"
                            data-period="1mo">1M</button>
                        <button
                            class="px-2 py-1 text-xs rounded bg-gray-700 text-gray-300 hover:bg-blue-600 hover:text-white transition-colors"
                            data-period="3mo">3M</button>
                        <button
                            class="px-2 py-1 text-xs rounded bg-gray-700 text-gray-300 hover:bg-blue-600 hover:text-white transition-colors"
                            data-period="6mo">6M</button>
                        <button class="px-2 py-1 text-xs rounded bg-blue-600 text-white" data-period="1y">1Y</button>
                        <button
                            class="px-2 py-1 text-xs rounded bg-gray-700 text-gray-300 hover:bg-blue-600 hover:text-white transition-colors"
                            data-period="2y">2Y</button>
                    </div>
                </div>

                <!-- Main Chart -->
                <div id="us-stock-chart" class="w-full h-[300px] mb-2 rounded bg-gray-900/30"></div>

                <!-- Sub Charts -->
                <div id="us-rsi-chart" class="w-full h-[80px] mb-1 hidden border-t border-[#2a2a2a] pt-1"></div>
                <div id="us-macd-chart" class="w-full h-[80px] mb-1 hidden border-t border-[#2a2a2a] pt-1"></div>

                <!-- AI Investment Summary -->
                <div class="mt-4 border-t border-[#2a2a2a] pt-4 flex-1 flex flex-col">
                    <div class="flex items-center justify-between mb-2">
                        <h3 class="text-sm font-bold text-gray-300 flex items-center gap-2">
                            <i class="fas fa-robot text-purple-400"></i> <span data-i18n-key="title_ai_summary">AI
                                Investment Summary</span>
                        </h3>
                        <div class="flex items-center gap-2">
                            <span id="us-ai-cache-badge" class="text-[11px] text-gray-500"></span>
                            <button id="us-ai-regen" data-i18n-key="btn_regen"
                                class="text-[11px] px-2 py-1 rounded bg-[#1a1a1a] border border-[#333] text-gray-300 hover:bg-[#2a2a2a]"
                                aria-label="Regenerate AI summary">Regenerate</button>
                            <button id="toggle-ai-panel"
                                class="text-[11px] px-2 py-1 rounded bg-[#1a1a1a] border border-[#333] text-gray-300 hover:bg-[#2a2a2a]">Collapse</button>
                            <span id="us-ai-updated" class="text-xs text-gray-500"></span>
                        </div>
                    </div>
                    <div id="ai-panel-body">
                        <div id="us-ai-summary"
                            class="bg-gray-800/50 rounded p-3 text-sm text-gray-300 leading-relaxed border border-gray-700 flex-1 overflow-y-auto max-h-[200px] custom-scrollbar">
                            <span data-i18n-key="ai_select_hint">Select a stock to view AI analysis...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sector Heatmap (Full Width, Larger) -->
            <div class="border border-[#2a2a2a] rounded-lg p-4 bg-[#1a1a1a] flex flex-col h-[450px]">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-base font-bold text-gray-200" data-i18n-key="title_sector_perf">Sector Performance
                    </h3>
                    <span id="us-heatmap-date" class="text-xs text-gray-500"></span>
                </div>
                <div id="us-sector-heatmap" class="flex-1 w-full"></div>
            </div>
        </div>
    </div>

    <!-- Bottom Section: Options Flow, Unusual Trades & Top Movers (3-Column Grid) -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
        <!-- Options Flow (Moved from middle section) -->
        <section class="border border-gray-800 rounded-lg p-4 bg-gray-900/50 backdrop-blur-sm">
            <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                    <h3 class="text-sm font-bold text-gray-300" data-i18n-key="title_options_flow">Options Flow
                        (Smart Money)</h3>
                    <span id="badge-options" class="text-[11px] text-gray-500"></span>
                </div>
                <span id="us-options-timestamp" class="text-xs text-gray-500"></span>
            </div>
            <div id="us-options-flow" class="space-y-2 h-[400px] overflow-y-auto custom-scrollbar">
                <!-- Options Items -->
            </div>
        </section>

        <!-- Unusual Trades -->
        <section class="border border-gray-800 rounded-lg p-4 bg-gray-900/50 backdrop-blur-sm">
            <div class="flex items-center justify-between mb-3">
                <div>
                    <h3 class="text-sm font-bold text-gray-300">Unusual Trades</h3>
                    <span id="us-unusual-updated" class="text-[11px] text-gray-500"></span>
                </div>
                <div class="flex items-center gap-2 flex-wrap">
                    <div class="flex items-center gap-1 bg-[#111] border border-[#333] rounded p-1">
                        <button id="unusual-side-all"
                            class="px-2 py-1 text-[11px] rounded bg-[#2a2a2a] text-white">All</button>
                        <button id="unusual-side-call"
                            class="px-2 py-1 text-[11px] rounded text-gray-300">Calls</button>
                        <button id="unusual-side-put" class="px-2 py-1 text-[11px] rounded text-gray-300">Puts</button>
                    </div>
                    <div class="flex items-center gap-1 bg-[#111] border border-[#333] rounded p-1">
                        <button class="unusual-score-btn px-2 py-1 text-[11px] rounded bg-[#2a2a2a] text-white"
                            data-score="70">70+</button>
                        <button class="unusual-score-btn px-2 py-1 text-[11px] rounded text-gray-300"
                            data-score="80">80+</button>
                        <button class="unusual-score-btn px-2 py-1 text-[11px] rounded text-gray-300"
                            data-score="90">90+</button>
                    </div>
                    <select id="unusual-sort"
                        class="bg-[#111] border border-[#333] text-[11px] text-gray-300 rounded px-2 py-1">
                        <option value="score">Score</option>
                        <option value="premium">Premium</option>
                    </select>
                    <button id="unusual-refresh"
                        class="text-[11px] px-3 py-1 rounded bg-[#1a1a1a] border border-[#333] text-gray-300 hover:bg-[#2a2a2a]">Refresh</button>
                    <button id="toggle-unusual-panel"
                        class="text-[11px] px-3 py-1 rounded bg-[#1a1a1a] border border-[#333] text-gray-300 hover:bg-[#2a2a2a]">Collapse</button>
                </div>
            </div>
            <div id="unusual-panel-body">
                <div id="us-unusual-list" class="space-y-2 h-[400px] overflow-y-auto custom-scrollbar">
                </div>
            </div>
        </section>

        <!-- Top Movers -->
        <section class="border border-gray-800 rounded-lg p-4 bg-gray-900/50 backdrop-blur-sm">
            <div class="flex items-center justify-between mb-3">
                <div class="flex items-center gap-2">
                    <h3 class="text-sm font-bold text-gray-300">Top Movers</h3>
                    <div class="flex items-center gap-1 bg-[#111] border border-[#333] rounded p-1">
                        <button id="tm-tab-1d" class="px-2 py-1 text-[11px] rounded bg-[#2a2a2a] text-white"
                            data-window="1d">1D</button>
                        <button id="tm-tab-1w" class="px-2 py-1 text-[11px] rounded text-gray-300"
                            data-window="1w">1W</button>
                    </div>
                    <span id="tm-updated" class="text-[11px] text-gray-500"></span>
                </div>
                <div class="flex items-center gap-2">
                    <input id="tm-search" type="text" placeholder="Search ticker"
                        class="bg-[#111] border border-[#333] text-[11px] text-gray-200 rounded px-2 py-1 w-32">
                    <button id="tm-refresh"
                        class="text-[11px] px-3 py-1 rounded bg-[#1a1a1a] border border-[#333] text-gray-300 hover:bg-[#2a2a2a]">Refresh</button>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-3">
                <div class="border border-[#333] rounded p-2">
                    <div class="flex items-center justify-between mb-1">
                        <span class="text-xs text-green-400 font-medium">▲ Gainers</span>
                    </div>
                    <div id="tm-gainers" class="space-y-1 h-[360px] overflow-y-auto custom-scrollbar"></div>
                </div>
                <div class="border border-[#333] rounded p-2">
                    <div class="flex items-center justify-between mb-1">
                        <span class="text-xs text-red-400 font-medium">▼ Losers</span>
                    </div>
                    <div id="tm-losers" class="space-y-1 h-[360px] overflow-y-auto custom-scrollbar"></div>
                </div>
            </div>
        </section>
    </div>
</div>